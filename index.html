<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ABDÃœLKADÄ°Râ€™Ä° TOKATLAMA OYUNU</title>

<style>
body{
  margin:0;
  background:linear-gradient(135deg,#1a2a3a,#243b55);
  color:white;
  font-family:Arial, sans-serif;
  overflow:hidden;
}
h1{text-align:center;margin:8px 0;font-size:22px;}

#canBar{
  width:75%;height:16px;background:#444;
  margin:auto;border-radius:10px;overflow:hidden;
}
#can{width:100%;height:100%;background:limegreen;}

#panel{text-align:center;margin-top:6px;font-size:15px;}

#oyun{position:relative;width:100%;height:70vh;}

#oyuncuFoto{
  position:absolute;
  top:50%;left:50%;
  width:300px;
  transform:translate(-50%,-50%);
  border-radius:15px;
  display:none;
  z-index:2;
}

/* SHAKE */
.foto-shake{animation:shake .18s;}
@keyframes shake{
  0%{transform:translate(-50%,-50%)}
  25%{transform:translate(-48%,-50%) rotate(1deg)}
  50%{transform:translate(-52%,-50%) rotate(-1deg)}
  75%{transform:translate(-48%,-50%) rotate(1deg)}
  100%{transform:translate(-50%,-50%)}
}

/* EL & YUMRUK */
.efekt{
  position:absolute;
  font-size:90px;
  z-index:3;
  opacity:0;
}
#elSag{right:6%;top:50%;transform:translateY(-50%);}
#elSol{left:6%;top:50%;transform:translateY(-50%) scaleX(-1);}
#yumruk{left:50%;top:15%;transform:translateX(-50%);}
</style>
</head>

<body>

<h1>ABDÃœLKADÄ°Râ€™Ä° TOKATLAMA OYUNU</h1>

<div id="canBar"><div id="can"></div></div>

<div id="panel">
  Tokat: <span id="sayac">0</span> |
  Combo: <span id="combo">x1</span> |
  Rekor: <span id="rekor">0</span>
</div>

<div id="oyun">
  <img id="oyuncuFoto">
  <div id="elSag" class="efekt">ðŸ‘‹</div>
  <div id="elSol" class="efekt">ðŸ‘‹</div>
  <div id="yumruk" class="efekt">ðŸ‘Š</div>
</div>

<script>
let maxCan=1000, can=maxCan;
let sayac=0;
let combo=1;
let lastHit=0;

let rekor = localStorage.getItem("rekor") || 0;
document.getElementById("rekor").innerText = rekor;

const foto=document.getElementById("oyuncuFoto");
const canBar=document.getElementById("can");
const sayacYazi=document.getElementById("sayac");
const comboYazi=document.getElementById("combo");

const elSag=document.getElementById("elSag");
const elSol=document.getElementById("elSol");
const yumruk=document.getElementById("yumruk");

const audioCtx=new (window.AudioContext||window.webkitAudioContext)();

function tokatSesi(){
  const buffer=audioCtx.createBuffer(1,audioCtx.sampleRate*0.12,audioCtx.sampleRate);
  const data=buffer.getChannelData(0);
  for(let i=0;i<data.length;i++){
    data[i]=(Math.random()*2-1)*(1-i/data.length);
  }
  const src=audioCtx.createBufferSource();
  src.buffer=buffer;
  src.connect(audioCtx.destination);
  src.start();
}

function yumrukSesi(){
  const osc=audioCtx.createOscillator();
  osc.frequency.value=90;
  osc.connect(audioCtx.destination);
  osc.start();
  osc.stop(audioCtx.currentTime+0.12);
}

function efekt(el){
  el.style.opacity=1;
  setTimeout(()=>el.style.opacity=0,120);
}

function salla(){
  foto.classList.add("foto-shake");
  setTimeout(()=>foto.classList.remove("foto-shake"),180);
}

function vur(tip){
  const now=Date.now();

  // KOMBO HESABI
  if(now-lastHit<600) combo++;
  else combo=1;

  lastHit=now;

  sayac+=combo;
  can-=10*combo;

  salla();

  if(tip==="sag"){efekt(elSag);tokatSesi();}
  if(tip==="sol"){efekt(elSol);tokatSesi();}
  if(tip==="yumruk"){efekt(yumruk);yumrukSesi();}

  if(can<=0){
    can=maxCan; // TOKAT SAYISI SIFIRLANMIYOR
  }

  if(sayac>rekor){
    rekor=sayac;
    localStorage.setItem("rekor",rekor);
    document.getElementById("rekor").innerText=rekor;
  }

  canBar.style.width=(can/maxCan*100)+"%";
  sayacYazi.innerText=sayac;
  comboYazi.innerText="x"+combo;
}

document.addEventListener("click",e=>{
  const w=innerWidth,h=innerHeight;
  if(e.clientY<h*0.25||e.clientY>h*0.75) vur("yumruk");
  else if(e.clientX<w/2) vur("sol");
  else vur("sag");
});

window.onload=()=>{
  foto.src="abdulkadir.png";
  foto.style.display="block";
};
</script>

</body>
</html>
