<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ABDÃœLKADÄ°R'Ä° TOKATLAMA OYUNU</title>
<style>
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#1e2f42;color:#fff;text-align:center}
  h1{margin:12px 0}
  #start{position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;z-index:10}
  #startBox{background:#111;padding:20px;border-radius:14px;width:80%;max-width:320px}
  #startBox input{width:100%;padding:12px;border-radius:10px;border:none;margin:10px 0;font-size:16px}
  #startBox button{padding:12px 24px;border-radius:10px;border:none;font-size:18px;cursor:pointer}
  #game{display:none}
  #bar{width:80%;height:18px;background:#444;border-radius:10px;margin:10px auto;overflow:hidden}
  #hp{height:100%;width:100%;background:lime}
  #stats{line-height:1.6}
  #wrap{position:relative;display:inline-block;margin-top:12px}
  #target{width:260px;border-radius:18px;user-select:none}
  .emoji{position:absolute;font-size:48px;animation:pop .5s ease-out forwards;pointer-events:none}
  @keyframes pop{0%{transform:scale(.4);opacity:1}100%{transform:scale(1.2);opacity:0}}
  #modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:20}
  #modalBox{background:#111;padding:16px;border-radius:14px;width:86%;max-width:420px;text-align:left}
  #modalBox h3{text-align:center;margin-top:0}
  #modalBox button{display:block;margin:12px auto 0;padding:10px 20px;border-radius:10px;border:none;font-size:16px}
</style>
</head>
<body>

<div id="start">
  <div id="startBox">
    <h2>Ä°smini Yaz</h2>
    <input id="username" placeholder="Ä°smin"/>
    <button onclick="startGame()">Oyna</button>
  </div>
</div>

<div id="game">
  <h1>ABDÃœLKADÄ°R'Ä° TOKATLAMA OYUNU</h1>
  <div id="bar"><div id="hp"></div></div>
  <div id="stats">
    Tokat: <span id="hits">0</span><br/>
    Rekor: <span id="record">0</span><br/>
    Can: <span id="healthText">10000</span><br/>
    Kalan Ã–lÃ¼m: <span id="killsLeft">100</span>
  </div>
  <div id="wrap">
    <img id="target" src="abdulkadir.png" />
  </div>
</div>

<div id="modal">
  <div id="modalBox">
    <h3>AbdÃ¼lkadir'den Mesaj</h3>
    <p id="story"></p>
    <p><b>Kalan Ã–lÃ¼m:</b> <span id="left2"></span></p>
    <button onclick="closeModal()">Tamam</button>
  </div>
</div>

<script>
/* ====== OYUN DEÄžÄ°ÅžKENLERÄ° ====== */
let maxHealth = 10000;
let health = maxHealth;
let damage = 20;
let hits = 0;

let totalKillsTarget = 100;
let killsDone = 0;

let record = Number(localStorage.getItem("rekor") || 0);
document.getElementById("record").innerText = record;
document.getElementById("killsLeft").innerText = totalKillsTarget - killsDone;

/* ====== BAÅžLAT ====== */
function startGame(){
  const name = (document.getElementById("username").value || "").trim().toLowerCase();
  if(name === "admin") damage = 2000;
  document.getElementById("start").style.display="none";
  document.getElementById("game").style.display="block";
}

/* ====== SES (WebAudio) ====== */
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function slapSound(){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type="square";
  o.frequency.setValueAtTime(180, audioCtx.currentTime);
  g.gain.setValueAtTime(0.2, audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+0.08);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.08);
}

/* ====== EMOJI ====== */
function showEmoji(type, x, y){
  const e = document.createElement("div");
  e.className="emoji";
  e.textContent = type;
  e.style.left = x+"px";
  e.style.top = y+"px";
  document.getElementById("wrap").appendChild(e);
  setTimeout(()=>e.remove(),500);
}

/* ====== TIKLAMA ====== */
document.getElementById("wrap").addEventListener("click",(ev)=>{
  slapSound();

  hits++;
  health -= damage;
  if(health < 0) health = 0;

  document.getElementById("hits").innerText = hits;
  document.getElementById("healthText").innerText = health;
  document.getElementById("hp").style.width = (health/maxHealth*100)+"%";

  if(hits > record){
    record = hits;
    localStorage.setItem("rekor", record);
    document.getElementById("record").innerText = record;
  }

  const rect = ev.currentTarget.getBoundingClientRect();
  const cx = rect.left + rect.width/2;
  const cy = rect.top + rect.height/2;

  let emoji = "ðŸ‘‹";
  if(Math.abs(ev.clientY - cy) > Math.abs(ev.clientX - cx)){
    emoji = "ðŸ‘Š"; // yukarÄ±/aÅŸaÄŸÄ±
  }
  const ex = ev.clientX - rect.left - 20;
  const ey = ev.clientY - rect.top - 20;
  showEmoji(emoji, ex, ey);

  if(health === 0){
    onDeath();
  }
});

/* ====== Ã–LÃœM ====== */
function onDeath(){
  killsDone++;
  const left = Math.max(0, totalKillsTarget - killsDone);
  document.getElementById("killsLeft").innerText = left;

  // mesaj
  document.getElementById("story").innerText =
  "Bir gÃ¼n 32 gelsin diye bekliyorum. AbdÃ¼lkadir geldi, Emirhan abi bir kere yalayayÄ±m mÄ± seninkini dedi. "+
  "Ben de dedim ki kardeÅŸim yok ya ÅŸimdi olur mu insanlar var. Ertesi gÃ¼n oldu tuvaletin orada kulaÄŸÄ±ma fÄ±sÄ±ldadÄ±, "+
  "abi dedi ÅŸu yalama iÅŸini bir halletsek. Ben de dedim kardeÅŸim olur ama bir fiyat konuÅŸmamÄ±z lazÄ±m. "+
  "Neyse geÃ§tik tuvalette konuÅŸuyoruz, fiyatta anlaÅŸamadÄ±k... ben bunu dÃ¶vdÃ¼m.";

  document.getElementById("left2").innerText = left;
  document.getElementById("modal").style.display="flex";

  // reset can
  health = maxHealth;
  document.getElementById("healthText").innerText = health;
  document.getElementById("hp").style.width = "100%";
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}
</script>
</body>
</html>
